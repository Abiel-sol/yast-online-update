@HEADER-COMMENT@

@HEADER@
BuildRequires:	gcc-c++ libxcrypt-devel perl-XML-Writer update-desktop-files pkg-config yast2-devtools yast2-packager yast2-bootloader
PreReq:		grep sed
# new registration of callbacks
Requires:	yast2-pkg-bindings >= 2.16.23
# PackagesUI::RunPackageSelector
Requires:	yast2 >= 2.17.40
# PackageCallbacks::FormatPatchName
Requires:	yast2-packager >= 2.13.159

Provides:	y2c_online_update yast2-config-online-update
Obsoletes:	y2c_online_update yast2-config-online-update
Provides:	yast2-trans-online-update y2t_online_update
Obsoletes:	yast2-trans-online-update y2t_online_update
BuildArchitectures:     noarch

Summary:    	YaST2 online update

%description
-

@PREP@

@BUILD@

@INSTALL@
mkdir -p "$RPM_BUILD_ROOT"@vardir@
cp $RPM_BUILD_ROOT/usr/share/applications/YaST2/cd_update.desktop $RPM_BUILD_ROOT/var/lib/YaST2/cd_update.desktop

@CLEAN@

%files
%defattr(-,root,root)
@scrconfdir@/*.scr
@clientdir@/online*.ycp
@clientdir@/cd_update.ycp
@clientdir@/inst_you.ycp
@clientdir@/do_online_update_auto.ycp
@moduledir@/OnlineUpdate*.ycp
@moduledir@/OnlineUpdate*.ybc
%doc @docdir@

%package frontend
Summary:	Desktop files for YaST2 online update
Requires:	yast2-online-update
Group:          System/YaST

%description frontend
-

%post frontend
if test "`uname -i`" = "s390" -o "`uname -i`" = "s390x"; then
    # remove the.desktop from the older unhacked package during update
    rm -f /usr/share/applications/YaST2/cd_update.desktop
else
    if [ -f /var/lib/YaST2/cd_update.desktop ] ; then
	cp /var/lib/YaST2/cd_update.desktop /usr/share/applications/YaST2/
    fi
fi

%files frontend
%defattr(-,root,root)
@desktopdir@/online_update.desktop
@vardir@/cd_update.desktop
%ghost @desktopdir@/cd_update.desktop
